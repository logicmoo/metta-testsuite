<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"
>
<title></title>
<style type="text/css"
>
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi31 { color: #aa0000; }
.ansi32 { color: #00aa00; }
.ansi33 { color: #aa5500; }
.ansi36 { color: #00aaaa; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165005 { color: #FFA505; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165005 { color: #FFA505; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165005 { color: #FFA505; }
.ansi38-013099040 { color: #0D6328; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content"
>
Script started on 2024-12-26 10:45:06+00:00 [COMMAND="timeout --preserve-status --foreground --signal=SIGTERM --kill-after=5s 40 swipl  /home/runner/work/metta-testsuite/metta-testsuite/prolog/metta_lang/metta_interp.pl -- --python=enable -- --timeout=40 --output=./reports/tests_output/baseline-compat/ --html --test tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta --halt=true  --stdin=tty --stdout=tty --stderr=tty" TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="-1" LINES="-1"]
P;HTML|
;         #(set_debug transpiler false)

P;HTML|
;          #(set_debug overtime 4.0)

P;HTML|
;          #(set_debug overflow 1000)

P;HTML|
;          #(set_debug eval false)

P;HTML|
;          #(set_debug load silent)

P;HTML|
;          #(set_debug trace-on-load false)

P;HTML|
;          #(set_debug exec false)

P;HTML|
;          #(set_debug error non-type)

P;HTML|
;          #(set_debug fail false)

P;HTML|
;          #(set_debug test true)

P;HTML|
;         #(set_debug test false)

P;HTML|
;         #(set_debug fail false)
P;HTML|
;          #(set_debug transpiler false)
P;HTML|
;          #(set_debug overtime 4.0)
P;HTML|
;          #(set_debug overflow 1000)
P;HTML|
;          #(set_debug eval false)
P;HTML|
;          #(set_debug load silent)
P;HTML|
;          #(set_debug trace-on-load false)
P;HTML|
;          #(set_debug exec false)
P;HTML|
;          #(set_debug error non-type)
P;HTML|
;          #(set_debug fail false)
P;HTML|
;          #(set_debug test true)
P;HTML|
;          #(set_debug test false)
P;HTML|
;          #(set_debug fail false)

; #( : user #(load_metta_file &self tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta) )
P;HTML|
;                #(track_load_into_file /home/runner/work/metta-testsuite/metta-testsuite/tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta)
P;HTML|
;                       #(load_answer_file /home/runner/work/metta-testsuite/metta-testsuite/tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta.answers /home/runner/work/metta-testsuite/metta-testsuite/tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta)
P;HTML|
;                        #( = 1 "[()]" )
P;HTML|
;                        #( = 2 "[(Error (assertEqualToResult (ListCount (Cons 1 (Cons 2 (Cons 3 (Cons 4 (Cons 5 (Cons 6 (Cons 7 (Cons 8 (Cons 9 (Cons 10 (Cons 11 (Cons 12 (Cons 13 (Cons 14 (Cons 15 (Cons 16 (Cons 17 (Cons 18 (Cons 19 (Cons 20 (Cons 21 (Cons 22 (Cons 23 (Cons 24 (Cons 25 (Cons 26 (Cons 27 (Cons 28 (Cons 29 (Cons 30 Nil)))))))))))))))))))))))))))))))) IncorrectNumberOfArguments)]" )
P;HTML|
;                         #( = 2 "0.30user 0.01system 0:00.32elapsed 99%CPU (0avgtext+0avgdata 31708maxresident)k" )
P;HTML|
;                         #( = 2 "0inputs+0outputs (0major+4316minor)pagefaults 0swaps" )


#(stream_error #( : 31 #( : 129 1260 ) ) #(syntax_error #(unexpected_char )) "Unexpected start character: ')'"))

<span class="ansi1 ansi31"
>ERROR: Unknown message: stream_error(31:129:1260,syntax_error(unexpected_char(')'),"Unexpected start character: ')'"))
</span>P;HTML|
;                        #(load_answer_file /home/runner/work/metta-testsuite/metta-testsuite/tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta.answers /home/runner/work/metta-testsuite/metta-testsuite/tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta)

;;; Test File: Recursive Tuple/List Deconstruction Performance in MeTTa
;;; Bug Report: https://github.com/trueagi-io/hyperon-experimental/issues/394
;;; Issue Overview:
;;; Recursive deconstruction of tuples or lists in MeTTa has suboptimal performance, 
;;; particularly for deep recursion. This test measures performance for TupleCount, 
;;; ListCount, BuildTuple, and BuildList functions.
;;; Example 1: TupleCount Performance
;;; ---------------------------------
<span class="ansi38-255165000"
> (= (TupleCount $tuple)  
  (if 
    (== $tuple ()) 0 
    (+ 1 
      (TupleCount (cdr-atom $tuple)))))
</span><span class="ansi38-255165005"
></span><span class="ansi36"
>transpiler_clause_store('TupleCount', 2, 0, ['Any'], 'AnyRet', [x(doeval, eager)], x(doeval, eager), ['TupleCount', _tuple], [if, [==, _tuple, []], 0, [+, 1, ['TupleCount', ['cdr-atom', _tuple]]]]).

</span><span class="pl-functor"
>[ </span>
  <span class="pl-atom"
>=</span>, 
  <span class="pl-compound pl-level-0"
><span class="pl-functor"
>mc_1__TupleCount</span>(<span class="pl-args"
><span class="pl-var"
>_tuple</span>, <span class="pl-var"
>A</span></span>)</span>, 
  [ [ <span class="pl-atom"
>prolog_if</span>, 
      [ <span class="pl-list"
><span class="pl-functor"
> [ </span><span class="pl-args"
><span class="pl-atom"
>assign</span>, <span class="pl-var"
>B</span>|<span class="pl-ellipsis"
>...</span></span>]</span>, 
        [ <span class="pl-atom"
>assign</span>, 
          <span class="pl-var"
>C</span>, 
          [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>call</span>(<span class="pl-args"
><span class="pl-atom"
>==</span></span>)</span>, <span class="pl-var"
>_tuple</span>, <span class="pl-var"
>B</span>]], 
        [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>native</span>(<span class="pl-args"
><span class="pl-atom"
>is_True</span></span>)</span>, 
          <span class="pl-var"
>C</span>]], 
      [ [ assign,  A   ,  0   ]], 
      [ [ <span class="pl-atom"
>assign</span>, 
          <span class="pl-var"
>D</span>, 
          [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>call</span>(<span class="pl-args"
><span class="pl-atom"
>'cdr-atom'</span></span>)</span>, 
            <span class="pl-var"
>_tuple</span>]], 
        [ <span class="pl-atom"
>assign</span>, 
          <span class="pl-var"
>E</span>, 
          [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>call</span>(<span class="pl-args"
><span class="pl-atom"
>'TupleCount'</span></span>)</span>, 
            <span class="pl-var"
>D</span>]], 
        [ <span class="pl-atom"
>assign</span>, 
          <span class="pl-var"
>F</span>, 
          [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>call</span>(<span class="pl-args"
><span class="pl-atom"
>+</span></span>)</span>, <span class="pl-int"
>1</span>, <span class="pl-var"
>E</span>]], 
        <span class="pl-list"
><span class="pl-functor"
> [ </span><span class="pl-args"
><span class="pl-atom"
>assign</span>, <span class="pl-var"
>A</span>|<span class="pl-ellipsis"
>...</span></span>]</span>]]]].&#13;&#10;
Asserting: transpiler_depends_on('TupleCount',2,==,3)
Asserting: transpiler_depends_on('TupleCount',2,'cdr-atom',2)
Asserting: transpiler_depends_on('TupleCount',2,+,3)
mc_1__TupleCount(_tuple, A) :-
    (   B=[],
        'mc_2__=='(_tuple, B, C),
        is_True(C)
    *-> A=0
    ;   'mc_1__cdr-atom'(_tuple, D),
        mc_1__TupleCount(D, E),
        'mc_2__+'(1, E, F),
        A=F
    ).
<span class="ansi36"
>
mc_1__TupleCount(_tuple, A) :-
    (   B=[],
        'mc_2__=='(_tuple, B, C),
        is_True(C)
    *-> A=0
    ;   'mc_1__cdr-atom'(_tuple, D),
        mc_1__TupleCount(D, E),
        'mc_2__+'(1, E, F),
        A=F
    ).

</span>
<span class="ansi38-013099040"
>!(assertEqualToResult (TupleCount (1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30)) (30))

</span>
;<h3 id="HYPERON-METTALOG-SANITY.RECURSIVE-TUPLE-LIST-PERF-HE-394.01"
>;; HYPERON-METTALOG-SANITY.RECURSIVE-TUPLE-LIST-PERF-HE-394.01</h3>
; 
; EVAL TEST
; took 0.039 secs. (39.14 milliseconds) 

!(assertEqualToResult (TupleCount (1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30)) (30))

<span class="ansi36"
>  #(loonit_success 
    #(equal_enough_for_test 
      (30) 
      (30)))
</span>
Deterministic: <span class="ansi33"
>()
</span>;;; Explanation:
;;; Counts the elements in a tuple. Tests for 30 elements.
;;; Example 2: ListCount Performance
;;; ---------------------------------
<span class="ansi38-255165000"
> (= (ListCount Nil)  0)
</span><span class="ansi38-255165005"
></span><span class="ansi36"
>transpiler_clause_store('ListCount', 2, 0, ['Any'], 'AnyRet', [x(doeval, eager)], x(doeval, eager), ['ListCount', 'Nil'], 0).

</span><span class="pl-functor"
>[ </span>
  <span class="pl-atom"
>=</span>, 
  <span class="pl-compound pl-level-0"
><span class="pl-functor"
>mc_1__ListCount</span>(<span class="pl-args"
><span class="pl-atom"
>'Nil'</span>, <span class="pl-int"
>0</span></span>)</span>, 
  []].&#13;&#10;
mc_1__ListCount('Nil', 0).
<span class="ansi36"
>
mc_1__ListCount('Nil', 0).

</span>
<span class="ansi38-255165000"
> (= (ListCount (Cons $head $tail))  
  (+ 1 
    (ListCount $tail)))
</span><span class="ansi38-255165005"
></span><span class="ansi36"
>transpiler_clause_store('ListCount', 2, 1, ['Any'], 'AnyRet', [x(doeval, eager)], x(doeval, eager), ['ListCount', ['Cons', _head, _tail]], [+, 1, ['ListCount', _tail]]).

</span><span class="pl-functor"
>[ </span>
  <span class="pl-atom"
>=</span>, 
  <span class="pl-compound pl-level-0"
><span class="pl-functor"
>mc_1__ListCount</span>(<span class="pl-args"
><span class="pl-list"
><span class="pl-functor"
> [ </span><span class="pl-args"
><span class="pl-atom"
>'Cons'</span>|<span class="pl-ellipsis"
>...</span></span>]</span>, <span class="pl-var"
>A</span></span>)</span>, 
  [ [ <span class="pl-atom"
>assign</span>, 
      <span class="pl-var"
>B</span>, 
      [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>call</span>(<span class="pl-args"
><span class="pl-atom"
>'ListCount'</span></span>)</span>, 
        <span class="pl-var"
>_tail</span>]], 
    [ <span class="pl-atom"
>assign</span>, 
      <span class="pl-var"
>A</span>, 
      [ <span class="pl-compound pl-level-0"
><span class="pl-functor"
>call</span>(<span class="pl-args"
><span class="pl-atom"
>+</span></span>)</span>, <span class="pl-int"
>1</span>, <span class="pl-compound pl-level-0"
><span class="pl-functor"
>'$VAR'</span>(<span class="pl-args"
><span class="pl-int"
>1</span></span>)</span>]]]].&#13;&#10;
Asserting: transpiler_depends_on('ListCount',2,+,3)
mc_1__ListCount(['Cons', _head, _tail], A) :-
    mc_1__ListCount(_tail, B),
    'mc_2__+'(1, B, A).
<span class="ansi36"
>
mc_1__ListCount(['Cons', _head, _tail], A) :-
    mc_1__ListCount(_tail, B),
    'mc_2__+'(1, B, A).

</span>
<span class="ansi38-013099040"
>!(assertEqualToResult (ListCount (Cons 1 (Cons 2 (Cons 3 (Cons 4 (Cons 5 (Cons 6 (Cons 7 (Cons 8 (Cons 9 (Cons 10 (Cons 11 (Cons 12 (Cons 13 (Cons 14 (Cons 15 (Cons 16 (Cons 17 (Cons 18 (Cons 19 (Cons 20 (Cons 21 (Cons 22 (Cons 23 (Cons 24 (Cons 25 (Cons 26 (Cons 27 (Cons 28 (Cons 29 (Cons 30 Nil))))))))))))))))))))))))))))))))

</span>
N(1): <span class="ansi33"
>(assertEqualToResult 30)
</span>P;HTML|
;                #( = /home/runner/work/metta-testsuite/metta-testsuite/tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta 0 )
<span class="ansi1"
>LoonIt Report
</span>------------
<span class="ansi32"
>Successes: 1
</span><span class="ansi32"
>Failures: 0
</span><br/> <a href="#" onclick="window.history.back(); return false;"
>Return to summaries</a><br/>
P;HTML|
;          #(set_debug transpiler false)
P;HTML|
;          #(set_debug overtime 4.0)
P;HTML|
;          #(set_debug overflow 1000)
P;HTML|
;          #(set_debug eval false)
P;HTML|
;          #(set_debug load silent)
P;HTML|
;          #(set_debug trace-on-load false)
P;HTML|
;          #(set_debug exec false)
P;HTML|
;          #(set_debug error non-type)
P;HTML|
;          #(set_debug fail false)
P;HTML|
;          #(set_debug test true)
P;HTML|
;          #(set_debug test false)
P;HTML|
;          #(set_debug fail false)
[()]
[(assertEqualToResult 30)]
P;HTML|
;           #(maybe_halt 7)
<span class="ansi31"
>#(in #(not_compat_io #(maybe_halt 7)) #(unwind #(halt 7)))
</span>
Script done on 2024-12-26 10:45:15+00:00 [COMMAND_EXIT_CODE="7"]

</pre>
</body>

</html>
\033[0;32mCompleted successfully (EXITCODE=7) Under 40 seconds: ./mettalog '--output=./reports/tests_output/baseline-compat/' --timeout=40 --html --repl=false  --test "tests/baseline_compat/hyperon-mettalog_sanity/recursive_tuple_list_perf_he_394.metta" --halt=true\033[0m
